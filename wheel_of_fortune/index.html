<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <script src="Winwheel.js"></script>
    <script src="wheel.js"></script>
</head>
<body>

<div align="center">
    <table cellpadding="0" cellspacing="0" border="0">
        <tr>
            <td>
                <div class="power_controls">
                    <br />
                    <br />
                    <table class="power" cellpadding="10" cellspacing="0">
                        <tr>
                            <th align="center">Power</th>
                        </tr>
                        <tr>
                            <td width="78" align="center" id="pw3" onClick="powerSelected(3);">High</td>
                        </tr>
                        <tr>
                            <td align="center" id="pw2" onClick="powerSelected(2);">Med</td>
                        </tr>
                        <tr>
                            <td align="center" id="pw1" onClick="powerSelected(1);">Low</td>
                        </tr>
                    </table>
                    <br />
                    <img id="spin_button" src="spin_off.png" alt="Spin" onClick="startSpin();" />
                    <br /><br />
                    &nbsp;&nbsp;<a href="#" onClick="resetWheel(); return false;">Play Again</a><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                </div>
            </td>
            <td width="438" height="582" class="the_wheel" align="center" valign="center">
                <canvas id="canvas" width="434" height="434">
                    <p style="{color: white}" align="center">Sorry, your browser doesn't support canvas. Please try another.</p>
                </canvas>
            </td>
            <td>
                <input type="text" id="newSegmentText" placeholder="Enter new segment text">
                <button onclick="addNewSegment()">Add New Segment</button>
            </td>
        </tr>
    </table>
</div>
<script>
    let theWheel = new Winwheel({

        'outerRadius': 212,
        'textFontSize': 28,
        'segments': [
            {'fillStyle': '#eae56f', 'text': 'IT-TEAM'},
        ],
        'animation': {
            'type': 'spinToStop',
            'duration': 5,
            'spins': 8,
            'callbackFinished': alertPrize
        }
    });


    function addNewSegment() {
        let newSegmentText = document.getElementById('newSegmentText').value;

        if (newSegmentText.trim() !== '') {

            let newSegment = {'fillStyle': getRandomColor(), 'text': newSegmentText};
            theWheel.addSegment(newSegment);
            theWheel.draw();
            document.getElementById('newSegmentText').value = '';
        }
    }

    function getRandomColor() {
        let letters = '0123456789ABCDEF';
        let color = '#';
        for (let i = 0; i < 6; i++) {
            color += letters[Math.floor(Math.random() * 16)];
        }
        return color;
    }

    let wheelPower    = 0;
    let wheelSpinning = false;
    function powerSelected(powerLevel)
    {
        if (wheelSpinning == false) {
            document.getElementById('pw1').className = "";
            document.getElementById('pw2').className = "";
            document.getElementById('pw3').className = "";
            if (powerLevel >= 1) {
                document.getElementById('pw1').className = "pw1";
            }

            if (powerLevel >= 2) {
                document.getElementById('pw2').className = "pw2";
            }

            if (powerLevel >= 3) {
                document.getElementById('pw3').className = "pw3";
            }
            wheelPower = powerLevel;
            document.getElementById('spin_button').src = "spin_on.png";
            document.getElementById('spin_button').className = "clickable";
        }
    }
    function startSpin()
    {
        if (wheelSpinning == false) {
            if (wheelPower == 1) {
                theWheel.animation.spins = 3;
            } else if (wheelPower == 2) {
                theWheel.animation.spins = 8;
            } else if (wheelPower == 3) {
                theWheel.animation.spins = 15;
            }

            document.getElementById('spin_button').src       = "spin_off.png";
            document.getElementById('spin_button').className = "";
            theWheel.startAnimation();
            wheelSpinning = true;
        }
    }
    function resetWheel()
    {
        theWheel.stopAnimation(false);
        theWheel.rotationAngle = 0;
        theWheel.draw();

        document.getElementById('pw1').className = "";
        document.getElementById('pw2').className = "";
        document.getElementById('pw3').className = "";

        wheelSpinning = false;
    }

    function alertPrize(indicatedSegment)
    {
        alert("Vyhr√°l jsi " + indicatedSegment.text + "!");
    }
</script>
</body>
</html>